<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vyrez – Admin</title>
  <style>
    :root { --navy:#0b1f3c; --blue:#3b5b8a; --panel:#f6f7f9; --text:#111622; --muted:#5b6472; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: linear-gradient(180deg, #ffffff, #f7f8fb); color: var(--text); }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 20px; }
    .card { background: #ffffff; border: 1px solid #e7ebf0; border-radius: 14px; padding: 16px; box-shadow: 0 10px 28px rgba(11,31,60,0.08); }
    input, textarea, select { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid #dfe6ed; background: #ffffff; color: var(--text); }
    button { appearance:none; border:0; border-radius:12px; padding:10px 14px; font-weight:700; background: linear-gradient(180deg, #3b5b8a, #0b1f3c); color:#fff; box-shadow:0 10px 20px rgba(11,31,60,0.18); cursor:pointer }
    .grid { display:grid; gap:16px; grid-template-columns: 1fr 1fr; }
    .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap }
    .muted { color: var(--muted); }
    table { width:100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid #e7ebf0; padding:8px; }
    .table-wrap { overflow:auto; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } .row input { flex: 1 1 100%; } .wrap { padding: 16px; } }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Admin Vyrez</h1>
    <div id="login" class="card">
      <div class="row"><div class="muted">Acesso</div></div>
      <div class="row"><input id="user" placeholder="Usuário" /><input id="pass" type="password" placeholder="Senha" /></div>
      <div class="row"><button id="doLogin">Entrar</button></div>
    </div>
    <div id="panel" style="display:none">
      <div class="grid">
        <div class="card">
          <h2>Configurações</h2>
          <div class="row"><input id="cfgBrand" placeholder="Marca" /><input id="cfgWhats" placeholder="WhatsApp (com DDI e DDD, ex: 5535984734190)" /></div>
          <div class="row"><input id="cfgHosting" placeholder="Preço da hospedagem" /><textarea id="cfgAnn" placeholder="Aviso/Anúncio"></textarea></div>
          <div class="row"><button id="saveCfg">Salvar Configurações</button></div>
        </div>
        <div class="card">
          <h2>Pedidos de Sites</h2>
          <div class="table-wrap"><table id="tblO"><thead><tr><th>ID</th><th>Nome</th><th>WhatsApp</th><th>Email</th><th>Tipo</th><th>Status</th><th>Ações</th></tr></thead><tbody></tbody></table></div>
        </div>
        <div class="card">
          <h2>Clientes</h2>
          <div class="table-wrap"><table id="tblC"><thead><tr><th>Nome</th><th>WhatsApp</th><th>Email</th><th>Desde</th></tr></thead><tbody></tbody></table></div>
        </div>
        <div class="card">
          <h2>Mensagens</h2>
          <textarea id="msgArea" placeholder="Escreva uma mensagem para lembrar ações"></textarea>
          <div class="row"><button id="addAnn">Adicionar Anúncio</button></div>
          <div class="muted">O anúncio mais recente aparece no formulário do site.</div>
        </div>
      </div>
    </div>
  </div>
  <script type="module">
    import {seed,getCfg,setCfg,getOrders,getClients,approveOrder,rejectOrder} from './store.js';
    seed();
    const login=document.getElementById('login');
    const panel=document.getElementById('panel');
    const u=document.getElementById('user');
    const p=document.getElementById('pass');
    document.getElementById('doLogin').addEventListener('click',()=>{ if(u.value==='admin'&&p.value==='Luckas2411'){ login.style.display='none'; panel.style.display='block'; render(); } else { alert('Credenciais inválidas'); } });
    function render(){ const cfg=getCfg(); document.getElementById('cfgBrand').value=cfg.brand||'Vyrez'; document.getElementById('cfgWhats').value=cfg.supportWhats||''; document.getElementById('cfgHosting').value=cfg.hostingPrice||12.5; const orders=getOrders(); const clients=getClients(); const tbodyO=document.querySelector('#tblO tbody'); tbodyO.innerHTML=''; for(const o of orders){ const p=o.payload||{}; const tr=document.createElement('tr'); tr.innerHTML=`<td>${o.id}</td><td>${p.nome||''}</td><td>${p.whatsapp||''}</td><td>${p.email||''}</td><td>${p.tipo||''}</td><td>${o.status}</td><td>${o.status==='awaiting_review'?'<button data-act="approve" data-id="'+o.id+'">Aprovar</button> <button data-act="reject" data-id="'+o.id+'">Rejeitar</button>':''}</td>`; tbodyO.appendChild(tr);} tbodyO.querySelectorAll('button').forEach(b=>b.addEventListener('click',onOrderAction)); const tbodyC=document.querySelector('#tblC tbody'); tbodyC.innerHTML=''; for(const c of clients){ const tr=document.createElement('tr'); const dt=new Date(c.createdAt||Date.now()); tr.innerHTML=`<td>${c.name||''}</td><td>${c.whatsapp||''}</td><td>${c.email||''}</td><td>${dt.toLocaleDateString()}</td>`; tbodyC.appendChild(tr);} }
    function onOrderAction(e){ const id=e.currentTarget.getAttribute('data-id'); const act=e.currentTarget.getAttribute('data-act'); if(act==='approve'){ approveOrder(id); render(); } else if(act==='reject'){ rejectOrder(id); render(); } }
    document.getElementById('saveCfg').addEventListener('click',()=>{ const cfg=getCfg(); cfg.brand=document.getElementById('cfgBrand').value||cfg.brand; cfg.supportWhats=document.getElementById('cfgWhats').value||cfg.supportWhats; cfg.hostingPrice=parseFloat(document.getElementById('cfgHosting').value||cfg.hostingPrice); setCfg(cfg); alert('Configuração salva.'); });
    document.getElementById('addAnn').addEventListener('click',()=>{ const cfg=getCfg(); const t=document.getElementById('msgArea').value; if(!t){ alert('Escreva algo'); return; } cfg.announcements=cfg.announcements||[]; cfg.announcements.unshift(t); setCfg(cfg); document.getElementById('msgArea').value=''; alert('Anúncio adicionado.'); });
  </script>
</body>
</html>
